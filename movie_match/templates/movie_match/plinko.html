{% extends 'home/Layout_v2.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" class="main-css" type="text/css" href="{% static 'movie_match/assets/css/Plinko.css' %}">
<!-- Page Content Start -->
<div class="canvas-container">
    <canvas id="moviePlinkoCanvas" width="340" height="500"></canvas>
    <!-- Hidden element to store movies data -->
    <div id="movies-data" style="display:none;">{{ interested_movies_json|safe }}</div>
</div>
<!-- Page Content End -->

<!-- Sliders -->
<div>
    <label for="imgWidth">Image Width:</label>
    <input type="range" id="imgWidth" name="imgWidth" min="1" max="100" value="42.5">
    <label for="imgHeight">Image Height:</label>
    <input type="range" id="imgHeight" name="imgHeight" min="1" max="500" value="100">
    <label for="imgX">Image X:</label>
    <input type="range" id="imgX" name="imgX" min="-340" max="340" value="0">
    <label for="imgY">Image Y:</label>
    <input type="range" id="imgY" name="imgY" min="-5000" max="500" value="0">
</div>

<script src="{% static 'movie_match/assets/js/plinko.js' %}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var canvas = document.getElementById('moviePlinkoCanvas');
        var movies = JSON.parse(document.getElementById('movies-data').textContent);

        // Scale the canvas to match its actual size
        const rect = canvas.getBoundingClientRect();
        canvas.width = rect.width;
        canvas.height = rect.height;

        // Initialize the Plinko game
        const plinko = new Plinko(canvas, movies);
        plinko.loop();

        canvas.addEventListener('click', (event) => {
            plinko.addBall(event.clientX, event.clientY);
        });

        // Update image dimensions and position when sliders change
        document.getElementById('imgWidth').addEventListener('change', function() {
            plinko.imgWidth = this.value;
        });
        document.getElementById('imgHeight').addEventListener('change', function() {
            plinko.imgHeight = this.value;
        });
        document.getElementById('imgX').addEventListener('change', function() {
            plinko.imgX = this.value;
        });
        document.getElementById('imgY').addEventListener('change', function() {
            plinko.imgY = this.value;
        });
    });
</script>
<!-- Modal -->
<div class="modal fade" id="exampleModalCenter">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Modal title</h5>
                <button class="btn-close" data-bs-dismiss="modal">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Cras mattis consectetur purus sit amet fermentum. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Morbi leo risus, porta ac consectetur ac, vestibulum at eros.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-sm btn-danger light" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-sm btn-primary Disliked">Disliked</button>
                <button type="button" class="btn btn-sm btn-primary Liked">Liked</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}